--USE G3R;
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--SELECT * FROM SISTEMA WHERE CODSIS = 'P3R';
--SELECT * FROM MODULO ORDER BY ID;
--SELECT * FROM MODULO_SISTEMA;
--SELECT * FROM GPESQUISA WHERE CODSIS='P3R';
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--Update SPRODUTO set VLMEDIO =55, VLVENDA=55 Where IDPROD=1;
--Update SPRODUTO set VLULTCOMPRA=12, VLMEDIO =12, VLVENDA=29 Where IDPROD=2;
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
DELETE FROM USUARIO WHERE IDUSU='DPIL';
DELETE FROM MODULO_SISTEMA WHERE CODSIS='P3R' AND Substring(IDMODU,3,1)<>'.';
DELETE FROM GPESQUISA WHERE CODSIS='P3R';
DELETE FROM GCAD WHERE CODSIS='P3R';
DELETE FROM MODULO WHERE Substring(IDMODU,3,1)<>'.';
DELETE FROM SISTEMA WHERE CODSIS = 'P3R' AND IDMODUDEFAULT<>(Select ID From MODULO Where IDMODU='ADMCALENDARIO');
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
if Not Exists(Select * FROM SISTEMA WHERE CODSIS = 'P3R' AND IDMODUDEFAULT In (Select ID From MODULO Where IDMODU='ADMCALENDARIO')) 
Begin 
   DELETE FROM MODULO_SISTEMA WHERE CODSIS='P3R'
   DELETE FROM GRPUSU_SISTEMA WHERE CODSIS = 'P3R'
   DELETE FROM SISTEMA WHERE CODSIS = 'P3R'
   INSERT SISTEMA(CODSIS,DSCSIS,SISPAI,CODVERSAOSIS,ATIVO,IDMODUDEFAULT) VALUES('P3R','Projeto 3R','','',1, Null) 
End;
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
SET IDENTITY_INSERT MODULO on;
INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (1 ,'ADM'             ,'Administração'           );
INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (2 ,'ADMADM'          ,'Administração do Sistema');
INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (3 ,'ADMADMMODU'      ,'Módulos do Sistema'      );
INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (4 ,'ADMADMBAK'       ,'Backup'                  );
INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (5 ,'ADMADMCFG'       ,'Configuração'            );
INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (6 ,'ADMCALENDARIO'   ,'Módulo Loja'             );
INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (7 ,'ADMGERENCIA'     ,'Módulo Gerência'         );
INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (8 ,'CAD'             ,'Cadastro'                );
INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (9 ,'CADCONFIG'       ,'Configurações'			 );
INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (10 ,'OPE'            ,'Operações'               );
INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (11,'OPEATEND'        ,'Atendimentos'            );
INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (12,'OPEVENDA'        ,'Vendas'                  );
INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (13,'OPEFATURA'       ,'Faturas'                 );
INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (14,'OPEDISPARO'      ,'Registro de Disparos'    );
INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (15,'REL'             ,'Relatórios'              );
INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (16,'CNSGERAL'        ,'Consulta Geral'          );
INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (17,'SEG'             ,'Segurança'               );
INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (18,'SEGPERFIL'       ,'Perfil'                  );
INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (19,'SEGUSU'          ,'Usuários'                );
INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (20,'UTIL'            ,'Utilitários'             );
INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (21,'UTILSINCDB'      ,'Sincronizar Bases'       );
INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (22,'UTILATUSIS'      ,'Atualização do Sistema'  );
INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (23,'CADCLI'          ,'Cliente'                 );
INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (24,'CADCOLIGADA'     ,'Coligada'                );
INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (25,'CADOMAQ'         ,'Máquina'                 );
INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (26,'CADEMPRESA'      ,'Estrutura/Empresa'       );
INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (27,'CADOCLASSE'      ,'Classe de Contatos'      );
INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (28,'CADOTPCONHEC'    ,'Tipo de Conhecimento'    );
INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (29,'CADSEST'         ,'Local de Estoque'        );
INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (30,'CADFDESPESA'     ,'Categoria da Despesa'    );
INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (31,'CADCCORRENTE'    ,'Conta Corrente'          );
INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (32,'CADOREACAOADV'   ,'Reação Adversa'          );
INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (33,'CADOAREA'        ,'Área de Aplicação'       );
INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (34,'CADRFUNCIONARIO' ,'Funcionário'			 );
INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (35,'CADOTPSERVICO'   ,'Tipo de Serviço'         );
INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (36,'CADOTPTRATAMENTO','Tratamento'              );
INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (37,'CADCCONDPGTO'    ,'Condição de Pagamento'   );
INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (38,'CADCFORMAPGTO'   ,'Forma de Pagamento'      );
INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (39,'CADOTPMAQ'	      ,'Tipo de Máquina'         );
INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (40,'CADOTPMANUT'     ,'Tipo de Manutenção'      );
INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (41,'CADOTPMANIPULO'  ,'Tipo de Manípulo'        );
INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (42,'CADOMANIPULO'    ,'Manípulo'				 );
INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (43,'CADOLAMPADA'     ,'Lâmpada'				 );
INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (44,'CADOAREATEMPO'   ,'Tempo por Área'			 );
INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (45,'CADCPROMOCAO'    ,'Descontos/Promoções'	 );
INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (46,'CADSPRODUTO'     ,'Produtos'				 );
INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (47,'CADOCONTATO'	  ,'Contato'				 );
INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (48,'CADOTRATAMENTO_PROD','Tratamentos x Produtos');

INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (49,'CADCLI_MALADIR'   ,'Mala Direta'			 );
INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (50,'RELGERENCIA'       ,'Consulta Gerencial'	 );
--INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (25,'CADOLOJA'        ,'Loja'                    );
--INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (26,'CADOSALA'        ,'Sala'                    );
--INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (36,'CADODIRECAO'     ,'Direção de Aplicação'    );
--INSERT MODULO(ID,IDMODU,DSCMODU) VALUES (40,'CADOFOTOTIPO'    ,'Fototipo'                );


SET IDENTITY_INSERT MODULO off;
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
UPDATE MODULO SET DSCMODU='Administração'           , MODUPAI=''      , SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='ADM';
UPDATE MODULO SET DSCMODU='Administração do Sistema', MODUPAI='ADM'   , SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='ADMADM';
UPDATE MODULO SET DSCMODU='Módulos do Sistema'      , MODUPAI='ADMADM', SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='ADMADMMODU';
UPDATE MODULO SET DSCMODU='Backup'                  , MODUPAI='ADMADM', SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='ADMADMBAK';
UPDATE MODULO SET DSCMODU='Configurações'           , MODUPAI='ADMADM', SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='ADMADMCFG';
UPDATE MODULO SET DSCMODU='Módulo Loja'             , MODUPAI='ADM'   , SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='ADMCALENDARIO';
UPDATE MODULO SET DSCMODU='Módulo Gerência'         , MODUPAI='ADM'   , SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='ADMGERENCIA';
UPDATE MODULO SET DSCMODU='Cadastro'                , MODUPAI='ADM'   , SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='CAD';
UPDATE MODULO SET DSCMODU='Cliente'                 , MODUPAI='CAD'   , SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='CADCLI';
UPDATE MODULO SET DSCMODU='Mala Direta'             , MODUPAI='CADCLI', SITMODU='S', MENUDEFAULT='N' WHERE IDMODU='CADCLI_MALADIR';
UPDATE MODULO SET DSCMODU='Configurações'           , MODUPAI='CAD'   , SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='CADCONFIG';
UPDATE MODULO SET DSCMODU='Operações'               , MODUPAI=''      , SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='OPE';
UPDATE MODULO SET DSCMODU='Atendimentos'            , MODUPAI='OPE'   , SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='OPEATEND';		--10
UPDATE MODULO SET DSCMODU='Vendas'                  , MODUPAI='OPE'   , SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='OPEVENDA';		
UPDATE MODULO SET DSCMODU='Faturas'                 , MODUPAI='OPE'   , SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='OPEFATURA';		
UPDATE MODULO SET DSCMODU='Registro de Disparos'    , MODUPAI='OPE'   , SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='OPEDISPARO';		
UPDATE MODULO SET DSCMODU='Relatórios'              , MODUPAI=''      , SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='REL';
UPDATE MODULO SET DSCMODU='Consulta Geral'          , MODUPAI='REL'   , SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='CNSGERAL';
UPDATE MODULO SET DSCMODU='Segurança'               , MODUPAI='CAD'   , SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='SEG';
UPDATE MODULO SET DSCMODU='Perfil'                  , MODUPAI='SEG'   , SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='SEGPERFIL';
UPDATE MODULO SET DSCMODU='Usuários'                , MODUPAI='SEG'   , SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='SEGUSU';
UPDATE MODULO SET DSCMODU='Utilitários'             , MODUPAI=''      , SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='UTIL';
UPDATE MODULO SET DSCMODU='Sincronizar Bases'	    , MODUPAI='UTIL'  , SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='UTILSINCDB';
UPDATE MODULO SET DSCMODU='Atualização do Sistema'  , MODUPAI='UTIL'  , SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='UTILATUSIS';
UPDATE MODULO SET DSCMODU='Consulta Gerencial'      , MODUPAI='REL'   , SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='RELGERENCIA';

  UPDATE MODULO SET DSCMODU='Coligada'                , MODUPAI='CADCONFIG'   , SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='CADCOLIGADA';
--  UPDATE MODULO SET DSCMODU='Loja'                    , MODUPAI='CADCONFIG'   , SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='CADOLOJA';		
--  UPDATE MODULO SET DSCMODU='Sala'                    , MODUPAI='CADCONFIG'   , SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='CADOSALA';		
--  UPDATE MODULO SET DSCMODU='Fototipo'                , MODUPAI='CADCONFIG'   , SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='CADOFOTOTIPO';
  UPDATE MODULO SET DSCMODU='Condição de Pagamento'   , MODUPAI='CADCONFIG'   , SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='CADCCONDPGTO';
  UPDATE MODULO SET DSCMODU='Forma de Pagamento'      , MODUPAI='CADCONFIG'   , SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='CADCFORMAPGTO';
--  UPDATE MODULO SET DSCMODU='Direção de Aplicação'    , MODUPAI='CADCONFIG'   , SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='CADODIRECAO';	  
  UPDATE MODULO SET DSCMODU='Tipo de Serviço'         , MODUPAI='CADCONFIG'   , SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='CADOTPSERVICO';  
  UPDATE MODULO SET DSCMODU='Tipo de Máquina'         , MODUPAI='CADCONFIG'   , SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='CADOTPMAQ';
  UPDATE MODULO SET DSCMODU='Tipo de Manípulo'        , MODUPAI='CADCONFIG'   , SITMODU='S', MENUDEFAULT='N' WHERE IDMODU='CADOTPMANIPULO';  
UPDATE MODULO SET DSCMODU='Local de Estoque'        , MODUPAI='CAD'   , SITMODU='N', MENUDEFAULT='S' WHERE IDMODU='CADSEST'; 
UPDATE MODULO SET DSCMODU='Máquina'                 , MODUPAI='CAD'   , SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='CADOMAQ';
UPDATE MODULO SET DSCMODU='Estrutura/Empresa'       , MODUPAI='CAD'   , SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='CADEMPRESA';
UPDATE MODULO SET DSCMODU='Classe de Contatos'      , MODUPAI='CAD'   , SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='CADOCLASSE';
UPDATE MODULO SET DSCMODU='Tipo de Conhecimento'    , MODUPAI='CAD'   , SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='CADOTPCONHEC';  
UPDATE MODULO SET DSCMODU='Categoria da Despesa'    , MODUPAI='CAD'   , SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='CADFDESPESA';
UPDATE MODULO SET DSCMODU='Conta Corrente'          , MODUPAI='CAD'   , SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='CADCCORRENTE';
UPDATE MODULO SET DSCMODU='Reação Adversa'          , MODUPAI='CAD'   , SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='CADOREACAOADV';
UPDATE MODULO SET DSCMODU='Área de Aplicação'       , MODUPAI='CAD'   , SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='CADOAREA';		  
UPDATE MODULO SET DSCMODU='Tratamento'				, MODUPAI='CAD'   , SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='CADOTPTRATAMENTO';
UPDATE MODULO SET DSCMODU='Funcionário'             , MODUPAI='CAD'   , SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='CADRFUNCIONARIO';
UPDATE MODULO SET DSCMODU='Tipo de Manutenção'	    , MODUPAI='CAD'   , SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='CADOTPMANUT';
UPDATE MODULO SET DSCMODU='Manípulo'				, MODUPAI='CAD'   , SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='CADOMANIPULO';
UPDATE MODULO SET DSCMODU='Lâmpada'					, MODUPAI='CAD'   , SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='CADOLAMPADA';
UPDATE MODULO SET DSCMODU='Tempo por Área'          , MODUPAI='CAD'   , SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='CADOAREATEMPO';
UPDATE MODULO SET DSCMODU='Descontos/Promoções'		, MODUPAI='CAD'   , SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='CADCPROMOCAO';
UPDATE MODULO SET DSCMODU='Produto'					, MODUPAI='CAD'   , SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='CADSPRODUTO';
UPDATE MODULO SET DSCMODU='Contato'					, MODUPAI='CAD'   , SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='CADOCONTATO';
UPDATE MODULO SET DSCMODU='Tratamento x Produto'	, MODUPAI='CAD'   , SITMODU='S', MENUDEFAULT='S' WHERE IDMODU='CADOTRATAMENTO_PROD';

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
UPDATE MODULO SET IDPAI=(SELECT	M2.ID FROM MODULO M2 WHERE M2.IDMODU=MODULO.MODUPAI)
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
UPDATE MODULO SET VBSCRIPT=''                              WHERE IDMODU='ADM';
UPDATE MODULO SET VBSCRIPT=''                              WHERE IDMODU='ADMADM';
UPDATE MODULO SET VBSCRIPT='"ACADASTRO.TL_CADMOD"'         WHERE IDMODU='ADMADMMODU';
UPDATE MODULO SET VBSCRIPT='SUB ITEM_MENU (SYS)
	EXISTE = SYS.EXISTEOBJETO("MODLOJA")
	IF EXISTE THEN
		SET MYOBJ=SYS.OBJETOS("MODLOJA")
	ELSE
		SET MYOBJ = CREATEOBJECT("SHORTBAR3R.TL_SHORTBAR")
		SYS.OBJETOS.ADD MYOBJ, "MODLOJA"
		SET MYOBJ.SYS = SYS
	END IF
	MYOBJ.SHOW
END SUB' 
WHERE IDMODU='ADMCALENDARIO';
UPDATE MODULO SET VBSCRIPT='SUB ITEM_MENU (SYS)
	EXISTE = SYS.EXISTEOBJETO("MODGERENCIA")
	IF EXISTE THEN
		SET MYOBJ=SYS.OBJETOS("MODGERENCIA")
	ELSE
		SET MYOBJ = CREATEOBJECT("GERENCIA3R.TL_SHORTBAR")
		SYS.OBJETOS.ADD MYOBJ, "MODGERENCIA"
		SET MYOBJ.SYS = SYS
	END IF
	MYOBJ.SHOW
END SUB' 
WHERE IDMODU='ADMGERENCIA';

UPDATE MODULO SET VBSCRIPT='SUB SINC_DB()
   SET NG = CREATEOBJECT("UTILITARIO3R.NG_UTILITARIO")
   WITH NG
      SET .SYS=SYS
      .F_SINCDB
   END WITH
END SUB'
WHERE IDMODU='UTILSINCDB';

UPDATE MODULO SET VBSCRIPT='SUB ITEM_MENU
   SET MYOBJ = CreateObject("VersaoFTP.TL_VerifVersao")
   MYOBJ.AutoStart = True
   MYOBJ.ShowCAVs
END SUB' 
WHERE IDMODU='UTILATUSIS';
UPDATE MODULO SET VBSCRIPT='"VersaoFTP.TL_VerifVersao"'		WHERE IDMODU='UTILATUSIS';
UPDATE MODULO SET VBSCRIPT='"CONTATO3R.TL_CADCLIENTE"'		WHERE IDMODU='CADCLI';
UPDATE MODULO SET VBSCRIPT='"CALENDARIO3R.TL_ATENDIMENTOs"'	WHERE IDMODU='OPEATEND';
UPDATE MODULO SET VBSCRIPT='"FINANC3R.TL_VENDAS"'	    	WHERE IDMODU='OPEVENDA';
UPDATE MODULO SET VBSCRIPT='"FINANC3R.TL_FATURAS"'		    WHERE IDMODU='OPEFATURA';
UPDATE MODULO SET VBSCRIPT='"CALENDARIO3R.TL_DISPARO"'		WHERE IDMODU='OPEDISPARO';
UPDATE MODULO SET VBSCRIPT='"CONSULTAGBL.TL_ConsGerais"'	WHERE IDMODU='CNSGERAL';
UPDATE MODULO SET VBSCRIPT='"CONSULTA3R.TL_Consulta3R"'		WHERE IDMODU='RELGERENCIA';
UPDATE MODULO SET VBSCRIPT='"ACADASTRO.TL_SEGURANCA"'		WHERE IDMODU='SEGPERFIL';
UPDATE MODULO SET VBSCRIPT='"ACADASTRO.TL_CADUSUARIO"'		WHERE IDMODU='SEGUSU';

UPDATE MODULO SET VBSCRIPT='"CADASTRO3R.TL_ODIRECAO"'		WHERE IDMODU='CADODIRECAO';
UPDATE MODULO SET VBSCRIPT='"CADASTRO3R.TL_OFOTOTIPO"'		WHERE IDMODU='CADOFOTOTIPO';
UPDATE MODULO SET VBSCRIPT='"CADASTRO3R.TL_CCONDPGTO"'		WHERE IDMODU='CADCCONDPGTO';
UPDATE MODULO SET VBSCRIPT='"CADASTRO3R.TL_CFORMAPGTO"'		WHERE IDMODU='CADCFORMAPGTO';
UPDATE MODULO SET VBSCRIPT='"CADASTRO3R.TL_OREACAOADV"'		WHERE IDMODU='CADOREACAOADV';
UPDATE MODULO SET VBSCRIPT='"CADASTRO3R.TL_EMPRESA"'		WHERE IDMODU='CADEMPRESA';

UPDATE MODULO SET VBSCRIPT='"CADASTRO3R.NG_CADASTRO.CADCCORRENTE"'	WHERE IDMODU='CADCCORRENTE'
UPDATE MODULO SET VBSCRIPT='"CADASTRO3R.NG_CADASTRO.CADCPROMOCAO"'	WHERE IDMODU='CADCPROMOCAO';
UPDATE MODULO SET VBSCRIPT='"CADASTRO3R.NG_CADASTRO.CADFDESPESA"'	WHERE IDMODU='CADFDESPESA'
UPDATE MODULO SET VBSCRIPT='"CADASTRO3R.NG_CADASTRO.CADOAREA"'		WHERE IDMODU='CADOAREA';
UPDATE MODULO SET VBSCRIPT='"CADASTRO3R.NG_CADASTRO.CADOAREATEMPO"' WHERE IDMODU='CADOAREATEMPO'
UPDATE MODULO SET VBSCRIPT='"CADASTRO3R.NG_CADASTRO.CADOCLASSE"'	WHERE IDMODU='CADOCLASSE'
UPDATE MODULO SET VBSCRIPT='"CADASTRO3R.NG_CADASTRO.CADOLAMPADA"'	WHERE IDMODU='CADOLAMPADA';
UPDATE MODULO SET VBSCRIPT='"CADASTRO3R.NG_CADASTRO.CADOMANIPULO"'	WHERE IDMODU='CADOMANIPULO';
UPDATE MODULO SET VBSCRIPT='"CADASTRO3R.NG_CADASTRO.CADOMAQ"'		WHERE IDMODU='CADOMAQ'
UPDATE MODULO SET VBSCRIPT='"CADASTRO3R.NG_CADASTRO.CADOREACAOADV"' WHERE IDMODU='CADOREACAOADV';
UPDATE MODULO SET VBSCRIPT='"CADASTRO3R.NG_CADASTRO.CADOTPCONHEC"'	WHERE IDMODU='CADOTPCONHEC'
UPDATE MODULO SET VBSCRIPT='"CADASTRO3R.NG_CADASTRO.CADOTPMANIPULO"' WHERE IDMODU='CADOTPMANIPULO';
UPDATE MODULO SET VBSCRIPT='"CADASTRO3R.NG_CADASTRO.CADOTPMANUT"'	WHERE IDMODU='CADOTPMANUT';
UPDATE MODULO SET VBSCRIPT='"CADASTRO3R.NG_CADASTRO.CADOTPMAQ"'		WHERE IDMODU='CADOTPMAQ';
UPDATE MODULO SET VBSCRIPT='"CADASTRO3R.NG_CADASTRO.CADOTPSERVICO"' WHERE IDMODU='CADOTPSERVICO';
UPDATE MODULO SET VBSCRIPT='"CADASTRO3R.NG_CADASTRO.CADOTPTRATAMENTO"' WHERE IDMODU='CADOTPTRATAMENTO';
UPDATE MODULO SET VBSCRIPT='"CADASTRO3R.NG_CADASTRO.CADSEST"'		WHERE IDMODU='CADSEST'
UPDATE MODULO SET VBSCRIPT='"CADASTRO3R.NG_CADASTRO.CADRFUNCIONARIO"' WHERE IDMODU='CADRFUNCIONARIO';
UPDATE MODULO SET VBSCRIPT='"CADASTRO3R.NG_CADASTRO.CADSPRODUTO"'	WHERE IDMODU='CADSPRODUTO'
UPDATE MODULO SET VBSCRIPT='"CADASTRO3R.NG_CADASTRO.TL_CADOTRATAMENTO_PROD"'	WHERE IDMODU='CADOTRATAMENTO_PROD'
UPDATE MODULO SET VBSCRIPT='"CADASTRO3R.NG_CADASTRO.TL_CADOCONTATO"' WHERE IDMODU='CADOCONTATO';

UPDATE MODULO SET VBSCRIPT='SUB DB_BACKUP()
   SET NG = CREATEOBJECT("UTILITARIO3R.NG_UTILITARIO")
   WITH NG
      SET .SYS=SYS
      .F_BACKUP
   END WITH
END SUB'
WHERE IDMODU='ADMADMBAK';

UPDATE MODULO SET VBSCRIPT='SUB SIS_CONFIG()
   EXISTE = SYS.EXISTEOBJETO("UTILITARIO3R")
   IF EXISTE THEN
      SET MYOBJ=SYS.OBJETOS("UTILITARIO3R")
   ELSE
      SET MYOBJ = CREATEOBJECT("UTILITARIO3R.NG_UTILITARIO")
      SYS.OBJETOS.ADD MYOBJ, "UTILITARIO3R"
      SET MYOBJ.SYS = SYS
   END IF

   WITH MYOBJ
      SET .SYS=SYS
      .F_CONFIG
   END WITH
END SUB'
WHERE IDMODU='ADMADMCFG';

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('ADM'             ,'P3R',0,'S',0);
INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('OPE'             ,'P3R',1,'S',0);
INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('REL'             ,'P3R',2,'S',0);
INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('UTIL'            ,'P3R',3,'S',0);

INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('ADMADM'				,'P3R',0,'S',0);
INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('ADMADMMODU'			,'P3R',0,'S',0);
INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('ADMADMBAK'			,'P3R',0,'S',0);
INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('ADMADMCFG'			,'P3R',0,'S',0);
INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('ADMCALENDARIO'		,'P3R',0,'S',1);
INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('ADMGERENCIA'			,'P3R',0,'S',1);
INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('CAD'					,'P3R',0,'S',1);
INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('CADCLI'				,'P3R',0,'S',0);
INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('CADCLI_MALADIR'		,'P3R',0,'N',0);
INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('OPEATEND'			,'P3R',0,'S',0);
INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('OPEDISPARO'			,'P3R',1,'S',1);
INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('OPEVENDA'			,'P3R',2,'S',2);
INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('OPEFATURA'			,'P3R',3,'S',2);
INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('CNSGERAL'			,'P3R',0,'S',1);
INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('RELGERENCIA'			,'P3R',0,'S',1);
INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('SEG'					,'P3R',0,'S',1);
INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('SEGPERFIL'			,'P3R',0,'S',0);
INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('SEGUSU'				,'P3R',0,'S',0);
INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('UTILSINCDB'			,'P3R',0,'S',0);
INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('UTILATUSIS'			,'P3R',0,'S',1);
INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('CADOMAQ'				,'P3R',0,'S',0);
INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('CADEMPRESA'			,'P3R',0,'S',0);
INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('CADOCLASSE'			,'P3R',0,'S',0);
INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('CADOTPCONHEC'		,'P3R',0,'S',0);
  INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('CADCONFIG'			,'P3R',0,'S',0);
  INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('CADCOLIGADA'		,'P3R',0,'S',0);  
  INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('CADOLOJA'			,'P3R',0,'S',0);
  INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('CADOSALA'			,'P3R',0,'S',0);
  INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('CADOREACAOADV'		,'P3R',0,'S',0);
  INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('CADODIRECAO'		,'P3R',0,'S',0);
  INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('CADOFOTOTIPO'		,'P3R',0,'S',0);
  INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('CADCCONDPGTO'		,'P3R',0,'S',0);
  INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('CADCFORMAPGTO'		,'P3R',0,'S',0);
  INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('CADSEST'				,'P3R',0,'S',0);
INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('CADFDESPESA'			,'P3R',0,'S',0);
INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('CADCCORRENTE'		,'P3R',0,'S',0);
INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('CADOAREA'			,'P3R',0,'S',0);
INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('CADOTPSERVICO'		,'P3R',0,'S',0);
INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('CADOTPTRATAMENTO'	,'P3R',0,'S',0);
INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('CADRFUNCIONARIO'		,'P3R',0,'S',0);
INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('CADOTPMAQ'			,'P3R',0,'S',0);
INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('CADOTPMANUT'			,'P3R',0,'N',0);
INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('CADOTPMANIPULO'		,'P3R',0,'N',0);
INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('CADOMANIPULO'		,'P3R',0,'S',0);
INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('CADOLAMPADA'			,'P3R',0,'S',0);
INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('CADOAREATEMPO'		,'P3R',0,'S',0);
INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('CADCPROMOCAO'		,'P3R',0,'S',0);
INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('CADSPRODUTO'			,'P3R',0,'S',0);
INSERT MODULO_SISTEMA(IDMODU,CODSIS,INDICE,MENU,GRUPOMENU) VALUES('CADOTRATAMENTO_PROD' ,'P3R',0,'S',0);

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
UPDATE MODULO_SISTEMA SET ID   =(SELECT M2.ID FROM MODULO M2 WHERE M2.IDMODU=MODULO_SISTEMA.IDMODU);
UPDATE MODULO_SISTEMA SET MODUPAI=(SELECT M2.MODUPAI FROM MODULO M2 WHERE M2.ID=MODULO_SISTEMA.ID);
UPDATE MODULO_SISTEMA SET IDPAI=(SELECT M2.ID FROM MODULO M2 WHERE M2.IDMODU=MODULO_SISTEMA.MODUPAI);
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--LoadMenuDefault
UPDATE SISTEMA Set IDMODUDEFAULT=(Select ID From MODULO Where IDMODU='ADMCALENDARIO') Where CODSIS='P3R'; 
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF Not Exists(Select IDGRUPO From GRPUSU Where IDGRUPO='LOJA') 
INSERT GRPUSU(IDGRUPO,DSCGRUPO) VALUES ('LOJA','Grupo de Acesso Loja');

IF Not Exists(Select IDGRUPO From GRPUSU Where IDGRUPO='MASTER') 
INSERT GRPUSU(IDGRUPO,DSCGRUPO) VALUES ('MASTER','Grupo de Acesso Gerencial');

IF Not Exists(Select IDGRUPO From GRPUSU Where IDGRUPO='ADMIN') 
INSERT GRPUSU(IDGRUPO,DSCGRUPO) VALUES ('ADMIN','Grupo de Acesso Administrador');

IF Not Exists(Select IDGRUPO From GRPUSU_SISTEMA Where IDGRUPO='LOJA' And CODSIS='P3R') 
INSERT GRPUSU_SISTEMA(IDGRUPO,CODSIS) VALUES ('LOJA','P3R');

IF Not Exists(Select IDGRUPO From GRPUSU_SISTEMA Where IDGRUPO='MASTER' And CODSIS='P3R') 
INSERT GRPUSU_SISTEMA(IDGRUPO,CODSIS) VALUES ('MASTER','P3R');

IF Not Exists(Select IDGRUPO From GRPUSU_SISTEMA Where IDGRUPO='MASTER' And CODSIS='P3R') 
INSERT GRPUSU_SISTEMA(IDGRUPO,CODSIS) VALUES ('ADMIN','P3R');

IF Not Exists(Select IDUSU From USUARIO Where IDUSU='DIO') 
INSERT USUARIO(IDUSU,IDGRUPO,SENHAUSU,NMUSU,DTCADASTRO,DTEXPIRAUSU,DTEXPIRASENHA,TPUSU,SITUSU,USUCADASTRO,FEXPIRASENHA,MATRUSU,ICORREIO,ECORREIO,ASSINATURA,TIMEOUT,IDSETOR,IDEMPR,LOCALTRAB,NIVELOS,NMAD,IDPESSOA,IDCOLIGADA,DTVALIDAUSU,TROCARSENHA) VALUES ('DIO','SISTEMA','7A7C717B78687E7C7A','Diogenes S. Ramos','2010-03-08', NULL, NULL,'','A', 'DIO', 0, '', '', 'suporte@classeanet.com.br', NULL,	0, 0, NULL,	NULL, 0, '', 0,	NULL, NULL, 0);

IF Not Exists(Select IDUSU From USUARIO Where IDUSU='LOJA') 
INSERT USUARIO(IDUSU,IDGRUPO,SENHAUSU,NMUSU,DTCADASTRO,DTEXPIRAUSU,DTEXPIRASENHA,TPUSU,SITUSU,USUCADASTRO,FEXPIRASENHA,MATRUSU,ICORREIO,ECORREIO,ASSINATURA,TIMEOUT,IDSETOR,IDEMPR,LOCALTRAB,NIVELOS,NMAD,IDPESSOA,IDCOLIGADA,DTVALIDAUSU,TROCARSENHA) VALUES ('LOJA','LOJA','','Usuário Loja','2010-03-08', NULL, NULL,'','A', 'DIO', 0, '', '', '', NULL,	0, 0, NULL,	NULL, 0, '', 0,	NULL, NULL, 0);

IF Not Exists(Select IDUSU From USUARIO Where IDUSU='MASTER') 
INSERT USUARIO(IDUSU,IDGRUPO,SENHAUSU,NMUSU,DTCADASTRO,DTEXPIRAUSU,DTEXPIRASENHA,TPUSU,SITUSU,USUCADASTRO,FEXPIRASENHA,MATRUSU,ICORREIO,ECORREIO,ASSINATURA,TIMEOUT,IDSETOR,IDEMPR,LOCALTRAB,NIVELOS,NMAD,IDPESSOA,IDCOLIGADA,DTVALIDAUSU,TROCARSENHA) VALUES ('MASTER','MASTER','','Usuário Master','2010-03-08', NULL, NULL,'','A', 'DIO', 0, '', '', '', NULL,	0, 0, NULL,	NULL, 0, '', 0,	NULL, NULL, 0);

IF Not Exists(Select IDUSU From USU_GRUPOS Where IDUSU='MASTER' And IDGRUPO='MASTER' ) 
INSERT USU_GRUPOS(IDUSU,IDGRUPO) VALUES ('MASTER','MASTER');

IF Not Exists(Select IDUSU From USU_GRUPOS Where IDUSU='LOJA' And IDGRUPO='LOJA' ) 
INSERT USU_GRUPOS(IDUSU,IDGRUPO) VALUES ('LOJA','LOJA');
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--SELECT * FROM GRPACESSO
DELETE FROM GRPACESSO WHERE IDGRUPO='LOJA';
INSERT GRPACESSO(IDMODU,IDGRUPO,CODACESSO,USUDELEGA) VALUES ('ADM','LOJA','LEIA','DIO');
INSERT GRPACESSO(IDMODU,IDGRUPO,CODACESSO,USUDELEGA) VALUES ('ADMADM','LOJA','LEIA','DIO');
INSERT GRPACESSO(IDMODU,IDGRUPO,CODACESSO,USUDELEGA) VALUES ('ADMADMBAK','LOJA','LEIA','DIO');
INSERT GRPACESSO(IDMODU,IDGRUPO,CODACESSO,USUDELEGA) VALUES ('ADMCALENDARIO','LOJA','LEIA','DIO');
INSERT GRPACESSO(IDMODU,IDGRUPO,CODACESSO,USUDELEGA) VALUES ('CAD','LOJA','LEIA','DIO');
INSERT GRPACESSO(IDMODU,IDGRUPO,CODACESSO,USUDELEGA) VALUES ('CADCLI','LOJA','LEIA','DIO');
INSERT GRPACESSO(IDMODU,IDGRUPO,CODACESSO,USUDELEGA) VALUES ('OPE','LOJA','LEIA','DIO');
INSERT GRPACESSO(IDMODU,IDGRUPO,CODACESSO,USUDELEGA) VALUES ('OPEATEND','LOJA','LEIA','DIO');
INSERT GRPACESSO(IDMODU,IDGRUPO,CODACESSO,USUDELEGA) VALUES ('OPEVENDA','LOJA','LEIA','DIO');
INSERT GRPACESSO(IDMODU,IDGRUPO,CODACESSO,USUDELEGA) VALUES ('OPEFATURA','LOJA','LEIA','DIO');
INSERT GRPACESSO(IDMODU,IDGRUPO,CODACESSO,USUDELEGA) VALUES ('OPEDISPARO','LOJA','LEIA','DIO');
INSERT GRPACESSO(IDMODU,IDGRUPO,CODACESSO,USUDELEGA) VALUES ('REL','LOJA','LEIA','DIO');
INSERT GRPACESSO(IDMODU,IDGRUPO,CODACESSO,USUDELEGA) VALUES ('CNSGERAL','LOJA','LEIA','DIO');
INSERT GRPACESSO(IDMODU,IDGRUPO,CODACESSO,USUDELEGA) VALUES ('UTIL','LOJA','LEIA','DIO');
INSERT GRPACESSO(IDMODU,IDGRUPO,CODACESSO,USUDELEGA) VALUES ('UTILATUSIS','LOJA','LEIA','DIO');

DELETE FROM GRPACESSO WHERE IDGRUPO='ADMIN';
INSERT GRPACESSO(IDMODU,IDGRUPO,CODACESSO,USUDELEGA) VALUES ('ADMGERENCIA','ADMIN','LEIA','DIO');
--INSERT GRPACESSO(IDMODU,IDGRUPO,CODACESSO,USUDELEGA) VALUES ('CADCLI_MALADIR','LOJA','LEIA','DIO');

DELETE FROM GRPACESSO WHERE IDGRUPO='MASTER';
INSERT GRPACESSO(IDMODU,IDGRUPO,CODACESSO,USUDELEGA)SELECT IDMODU,'MASTER','LEIA','DIO' FROM MODULO;
DELETE FROM GRPACESSO WHERE IDGRUPO='MASTER' And IDMODU='ADMADMMODU';
DELETE FROM GRPACESSO WHERE IDGRUPO='MASTER' And IDMODU='CADCONFIG';
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
UPDATE GRPACESSO SET ID=(SELECT M2.ID FROM MODULO M2 WHERE M2.IDMODU=GRPACESSO.IDMODU);
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
DELETE FROM GCAD WHERE CODSIS='P3R';
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

--**Substituido pelo sistema
--INSERT INTO GCAD (IDMODU, CODSIS, GRUPO) SELECT ID, 'P3R', NULL FROM MODULO WHERE IDMODU='CADEMPRESA';
INSERT INTO GCAD (IDMODU, CODSIS, GRUPO) VALUES ('CADOMAQ', 'P3R', NULL);
--INSERT INTO GCAD (IDMODU, CODSIS, GRUPO) VALUES ('CADEMPRESA', 'P3R', NULL);
INSERT INTO GCAD (IDMODU, CODSIS, GRUPO) VALUES ('CADOCLASSE', 'P3R', NULL);
INSERT INTO GCAD (IDMODU, CODSIS, GRUPO) VALUES ('CADOTPCONHEC', 'P3R', NULL);
INSERT INTO GCAD (IDMODU, CODSIS, GRUPO) VALUES ('CADFDESPESA', 'P3R', NULL);
INSERT INTO GCAD (IDMODU, CODSIS, GRUPO) VALUES ('CADCCORRENTE', 'P3R', NULL);
INSERT INTO GCAD (IDMODU, CODSIS, GRUPO) VALUES ('CADRFUNCIONARIO', 'P3R', NULL);

UPDATE GCAD SET TL_CAD=''						, CONSULTA='Select IDLOJA, IDCONTA, IDCONTA [Id.], DSCCONTA [Nome], NUMBANCO [Banco], NUMAGENCIA [Agência], NUMCONTA+' + Char(39)+'-'+Char(39)+'+DVCONTA [Conta], TPCONTA [Tipo] From FCCORRENTE', TAGCAMPOS='|CAMPO=IDLOJA|CHAVE=S|GRUPO=0|VISIBLE=N:|CAMPO=IDCONTA|CHAVE=S|GRUPO=0|VISIBLE=N:' WHERE IDMODU ='CADCCORRENTE';
UPDATE GCAD SET TL_CAD=''                       , CONSULTA='Select IDREACAOADV, IDREACAOADV [Id.], DSCREACAOADV [Descrição] From OREACAOADV', TAGCAMPOS='|CAMPO=IDREACAOADV|CHAVE=S|GRUPO=0|VISIBLE=N:' WHERE IDMODU ='CADOREACAOADV';
UPDATE GCAD SET TL_CAD='TL_CADRFUNCIONARIO'		, CONSULTA='Select IDLOJA, IDFUNCIONARIO, CHAPA, NOME, DTADMISSAO [ADMISSÃO], DTDEMISSAO [DEMISSÃO] From RFUNCIONARIO', TAGCAMPOS='|CAMPO=IDLOJA|CHAVE=S|GRUPO=0|VISIBLE=N:|CAMPO=IDFUNCIONARIO|CHAVE=S|GRUPO=0|VISIBLE=N:' WHERE IDMODU ='CADRFUNCIONARIO';
UPDATE GCAD SET TL_CAD=''                       , CONSULTA='', TAGCAMPOS='' WHERE IDMODU ='CADSEST';
UPDATE GCAD SET TL_CAD=''                       , CONSULTA='', TAGCAMPOS='' WHERE IDMODU ='CADODIRECAO';
UPDATE GCAD SET TL_CAD=''                       , CONSULTA='', TAGCAMPOS='' WHERE IDMODU ='CADOFOTOTIPO';
UPDATE GCAD SET TL_CAD=''                       , CONSULTA='', TAGCAMPOS='' WHERE IDMODU ='CADCCONDPGTO';
UPDATE GCAD SET TL_CAD=''                       , CONSULTA='', TAGCAMPOS='' WHERE IDMODU ='CADCFORMAPGTO';
UPDATE GCAD SET TL_CAD=''                       , CONSULTA='Select M.CODMANIPULO [Manípulo], L.IDLAMP [Lâmpada], M.IDMANIPULO From OLAMPADA L JOIN OMANIPULO M ON M.IDMANIPULO=L.IDMANIPULO', TAGCAMPOS='|CAMPO=IDMANIPULO|CHAVE=S|GRUPO=0|VISIBLE=N:|CAMPO=IDLAMP|CHAVE=S|GRUPO=0|VISIBLE=N:' WHERE IDMODU ='CADOLAMPADA';
UPDATE GCAD SET TL_CAD=''                       , CONSULTA='Select R.DSCTRATAMENTO [Tratamento], M.DSCMANIPULO [Manípulo], A.DSCAREA [Área], T.TEMPOMED [Tempo Médio], T.IDAREA, T.IDTPTRATAMENTO, T.IDTPMANIPULO From OAREA_TRATAMENTO T JOIN OAREA A ON A.IDAREA=T.IDAREA JOIN OTPTRATAMENTO R ON T.IDTPTRATAMENTO=R.IDTPTRATAMENTO JOIN OTPMANIPULO M ON T.IDTPMANIPULO=M.IDTPMANIPULO', TAGCAMPOS='|CAMPO=IDAREA|CHAVE=S|GRUPO=0|VISIBLE=N:|CAMPO=IDTPTRATAMENTO|CHAVE=S|GRUPO=0|VISIBLE=N:|CAMPO=IDTPMANIPULO|CHAVE=S|GRUPO=0|VISIBLE=N:|CAMPO=TEMPOMED|CHAVE=N|GRUPO=0|VISIBLE=S:' WHERE IDMODU ='CADOAREATEMPO';
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
UPDATE GCAD SET ID=(SELECT M2.ID FROM MODULO M2 WHERE M2.IDMODU=GCAD.IDMODU);
